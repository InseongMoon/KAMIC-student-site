<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì´ë¯¸ì§€ ë„êµ¬ - KAMIC Lab</title>
    <!-- UTIF.js for TIFF files -->
    <script src="https://cdn.jsdelivr.net/npm/utif@3.1.0/UTIF.min.js"></script>
    <!-- PSD.js for PSD files -->
    <script src="https://cdn.jsdelivr.net/npm/psd.js@3.4.0/dist/psd.min.js"></script>
    <!-- Cropper.js for image cropping -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans KR', 'Segoe UI', sans-serif;
            background: linear-gradient(135deg, #1e3a5f 0%, #2d1b4e 50%, #1a1a2e 100%);
            min-height: 100vh;
            color: #e4e4e7;
        }

        /* í—¤ë” */
        header {
            background: rgba(15, 15, 35, 0.95);
            backdrop-filter: blur(20px);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.4);
            position: sticky;
            top: 0;
            z-index: 1000;
            border-bottom: 1px solid rgba(255, 255, 255, 0.08);
        }

        .navbar {
            max-width: 1600px;
            margin: 0 auto;
            padding: 1rem 2rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo h2 {
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 1.8rem;
            font-weight: 700;
        }

        .logo h2 a {
            text-decoration: none;
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .nav-title {
            font-size: 1.4rem;
            font-weight: 600;
            color: #fff;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .nav-title::before {
            content: 'ğŸ–¼ï¸';
            font-size: 1.6rem;
        }

        .back-btn {
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            font-size: 0.95rem;
        }

        .back-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(244, 114, 182, 0.4);
        }

        /* ë©”ì¸ ì»¨í…ì¸  */
        main {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }

        /* íƒ­ ë„¤ë¹„ê²Œì´ì…˜ */
        .tab-nav {
            display: flex;
            gap: 0.5rem;
            margin-bottom: 2rem;
            background: rgba(30, 30, 60, 0.6);
            padding: 0.5rem;
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .tab-btn {
            flex: 1;
            background: transparent;
            border: none;
            padding: 1rem 2rem;
            color: #a1a1aa;
            font-weight: 600;
            font-size: 1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .tab-btn.active {
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            color: white;
            box-shadow: 0 4px 20px rgba(244, 114, 182, 0.3);
        }

        .tab-btn:hover:not(.active) {
            background: rgba(255, 255, 255, 0.1);
            color: #fff;
        }

        /* íƒ­ ì»¨í…ì¸  */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* ê³µí†µ ì„¹ì…˜ ìŠ¤íƒ€ì¼ */
        .section-card {
            background: rgba(30, 30, 60, 0.6);
            border-radius: 24px;
            padding: 2rem;
            margin-bottom: 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .section-title {
            font-size: 1.3rem;
            font-weight: 600;
            color: #fff;
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        /* ì—…ë¡œë“œ ì˜ì—­ */
        .upload-area {
            background: rgba(20, 20, 50, 0.5);
            border: 3px dashed rgba(244, 114, 182, 0.4);
            border-radius: 20px;
            padding: 3rem 2rem;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .upload-area:hover,
        .upload-area.drag-over {
            border-color: #f472b6;
            background: rgba(244, 114, 182, 0.1);
            transform: scale(1.01);
        }

        .upload-icon {
            font-size: 4rem;
            margin-bottom: 1rem;
            animation: bounce 2s ease-in-out infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .upload-area h3 {
            font-size: 1.4rem;
            margin-bottom: 0.75rem;
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .upload-area p {
            color: #a1a1aa;
            margin-bottom: 1rem;
        }

        .upload-btn {
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 1rem;
        }

        .upload-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(244, 114, 182, 0.4);
        }

        .supported-formats {
            margin-top: 1rem;
            display: flex;
            justify-content: center;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .format-badge {
            background: rgba(255, 255, 255, 0.1);
            padding: 0.3rem 0.6rem;
            border-radius: 15px;
            font-size: 0.75rem;
            color: #d4d4d8;
        }

        /* ë¯¸ë¦¬ë³´ê¸° ì˜ì—­ */
        .preview-area {
            display: none;
            margin-top: 1.5rem;
        }

        .preview-area.show {
            display: block;
        }

        .preview-container {
            display: flex;
            gap: 2rem;
            flex-wrap: wrap;
        }

        .preview-box {
            flex: 1;
            min-width: 300px;
            background: rgba(0, 0, 0, 0.3);
            border-radius: 16px;
            padding: 1rem;
            text-align: center;
        }

        .preview-box h4 {
            color: #a1a1aa;
            margin-bottom: 1rem;
            font-size: 0.9rem;
        }

        .preview-image-container {
            background: repeating-conic-gradient(#333 0% 25%, #444 0% 50%) 50% / 20px 20px;
            border-radius: 12px;
            overflow: hidden;
            min-height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        .preview-image {
            max-width: 100%;
            max-height: 400px;
            object-fit: contain;
        }

        .image-info {
            margin-top: 1rem;
            padding: 1rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 10px;
            font-size: 0.85rem;
            color: #a1a1aa;
        }

        .image-info p {
            margin: 0.3rem 0;
        }

        .image-info span {
            color: #f472b6;
            font-weight: 600;
        }

        /* ì˜µì…˜ ì˜ì—­ */
        .options-area {
            margin-top: 1.5rem;
            padding: 1.5rem;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 16px;
        }

        .option-group {
            margin-bottom: 1.5rem;
        }

        .option-group:last-child {
            margin-bottom: 0;
        }

        .option-label {
            display: block;
            color: #fff;
            font-weight: 500;
            margin-bottom: 0.75rem;
            font-size: 0.95rem;
        }

        .option-row {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .format-select,
        .number-input,
        .quality-slider {
            background: rgba(0, 0, 0, 0.3);
            border: 2px solid rgba(255, 255, 255, 0.1);
            color: #fff;
            padding: 0.75rem 1rem;
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
        }

        .format-select:focus,
        .number-input:focus {
            outline: none;
            border-color: #f472b6;
            box-shadow: 0 0 0 3px rgba(244, 114, 182, 0.2);
        }

        .format-select option {
            background: #1a1a2e;
            color: #fff;
        }

        .number-input {
            width: 120px;
        }

        .quality-container {
            display: flex;
            align-items: center;
            gap: 1rem;
            flex: 1;
        }

        .quality-slider {
            flex: 1;
            -webkit-appearance: none;
            height: 8px;
            border-radius: 4px;
            background: rgba(255, 255, 255, 0.1);
            padding: 0;
            cursor: pointer;
        }

        .quality-slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            cursor: pointer;
            box-shadow: 0 2px 10px rgba(244, 114, 182, 0.4);
        }

        .quality-value {
            color: #f472b6;
            font-weight: 600;
            min-width: 50px;
            text-align: right;
        }

        /* ì•¡ì…˜ ë²„íŠ¼ */
        .action-buttons {
            display: flex;
            gap: 1rem;
            margin-top: 1.5rem;
            flex-wrap: wrap;
        }

        .action-btn {
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            color: white;
            border: none;
            padding: 0.8rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .action-btn:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(244, 114, 182, 0.4);
        }

        .action-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .action-btn.secondary {
            background: rgba(255, 255, 255, 0.1);
        }

        .action-btn.secondary:hover:not(:disabled) {
            background: rgba(255, 255, 255, 0.2);
            box-shadow: none;
        }

        .action-btn.success {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        }

        .action-btn.success:hover:not(:disabled) {
            box-shadow: 0 8px 25px rgba(16, 185, 129, 0.4);
        }

        /* í¬ë¡­ ì˜ì—­ */
        .crop-container {
            display: none;
            margin-top: 1.5rem;
        }

        .crop-container.show {
            display: block;
        }

        .crop-preview {
            max-height: 500px;
            overflow: hidden;
            border-radius: 12px;
            background: #000;
        }

        .crop-preview img {
            max-width: 100%;
            display: block;
        }

        .crop-controls {
            display: flex;
            gap: 1rem;
            margin-top: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .aspect-ratio-btns {
            display: flex;
            gap: 0.5rem;
        }

        .ratio-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #a1a1aa;
            padding: 0.5rem 1rem;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.85rem;
        }

        .ratio-btn.active,
        .ratio-btn:hover {
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            color: white;
        }

        /* ë¦¬ì‚¬ì´ì¦ˆ ì˜µì…˜ */
        .resize-options {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
            align-items: center;
        }

        .resize-input-group {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .resize-input-group label {
            color: #a1a1aa;
            font-size: 0.9rem;
        }

        .lock-ratio-btn {
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: #a1a1aa;
            width: 36px;
            height: 36px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }

        .lock-ratio-btn.active {
            background: linear-gradient(135deg, #f472b6 0%, #8b5cf6 100%);
            color: white;
        }

        /* í”„ë¡œê·¸ë ˆìŠ¤ ì˜¤ë²„ë ˆì´ */
        .progress-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(10px);
            z-index: 2000;
            justify-content: center;
            align-items: center;
        }

        .progress-overlay.show {
            display: flex;
        }

        .progress-card {
            background: rgba(30, 30, 60, 0.95);
            border-radius: 24px;
            padding: 3rem;
            text-align: center;
            max-width: 400px;
            width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .spinner {
            width: 50px;
            height: 50px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top-color: #f472b6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1.5rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .progress-card h3 {
            color: #fff;
            margin-bottom: 1rem;
        }

        /* í† ìŠ¤íŠ¸ ì•Œë¦¼ */
        .toast-container {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 3000;
            display: flex;
            flex-direction: column;
            gap: 0.75rem;
        }

        .toast {
            background: rgba(30, 30, 60, 0.95);
            border-radius: 12px;
            padding: 1rem 1.5rem;
            display: flex;
            align-items: center;
            gap: 0.75rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.4);
            animation: slideIn 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .toast.success { border-left: 4px solid #10b981; }
        .toast.error { border-left: 4px solid #ef4444; }
        .toast.info { border-left: 4px solid #f472b6; }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        /* í‘¸í„° */
        footer {
            background: rgba(15, 15, 35, 0.95);
            text-align: center;
            padding: 1.5rem;
            margin-top: 3rem;
            border-top: 1px solid rgba(255, 255, 255, 0.08);
        }

        footer p {
            color: #71717a;
            font-size: 0.9rem;
        }

        /* ë°˜ì‘í˜• */
        @media (max-width: 768px) {
            .navbar {
                flex-direction: column;
                gap: 1rem;
            }

            .tab-nav {
                flex-direction: column;
            }

            .preview-container {
                flex-direction: column;
            }

            .resize-options {
                flex-direction: column;
                align-items: flex-start;
            }
        }

        /* Cropper.js ìŠ¤íƒ€ì¼ ì˜¤ë²„ë¼ì´ë“œ */
        .cropper-view-box,
        .cropper-face {
            border-radius: 0;
        }

        .cropper-line {
            background-color: #f472b6;
        }

        .cropper-point {
            background-color: #f472b6;
            width: 10px;
            height: 10px;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <h2><a href="index.html">KAMIC Lab</a></h2>
            </div>
            <div class="nav-title">ì´ë¯¸ì§€ ë„êµ¬</div>
            <a href="index.html" class="back-btn">â† í™ˆìœ¼ë¡œ</a>
        </nav>
    </header>

    <main>
        <!-- íƒ­ ë„¤ë¹„ê²Œì´ì…˜ -->
        <div class="tab-nav">
            <button class="tab-btn active" data-tab="convert" onclick="switchTab('convert')">
                ğŸ”„ í™•ì¥ì ë³€í™˜
            </button>
            <button class="tab-btn" data-tab="edit" onclick="switchTab('edit')">
                âœ‚ï¸ ì´ë¯¸ì§€ í¸ì§‘
            </button>
        </div>

        <!-- í™•ì¥ì ë³€í™˜ íƒ­ -->
        <div class="tab-content active" id="convertTab">
            <div class="section-card">
                <h3 class="section-title">ğŸ”„ ì´ë¯¸ì§€ í™•ì¥ì ë³€í™˜</h3>
                
                <div class="upload-area" id="convertUploadArea" onclick="document.getElementById('convertFileInput').click()">
                    <div class="upload-icon">ğŸ“·</div>
                    <h3>ì´ë¯¸ì§€ë¥¼ ë“œë˜ê·¸í•˜ê±°ë‚˜ í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</h3>
                    <p>ë³€í™˜í•  ì´ë¯¸ì§€ íŒŒì¼ì„ ì„ íƒí•˜ì„¸ìš”</p>
                    <button class="upload-btn" onclick="event.stopPropagation();">íŒŒì¼ ì„ íƒ</button>
                    <div class="supported-formats">
                        <span class="format-badge">JPG</span>
                        <span class="format-badge">PNG</span>
                        <span class="format-badge">GIF</span>
                        <span class="format-badge">TIFF</span>
                        <span class="format-badge">SVG</span>
                        <span class="format-badge">WebP</span>
                        <span class="format-badge">PSD</span>
                    </div>
                    <input type="file" id="convertFileInput" accept=".jpg,.jpeg,.png,.gif,.tiff,.tif,.svg,.webp,.psd" style="display: none">
                </div>

                <div class="preview-area" id="convertPreviewArea">
                    <div class="preview-container">
                        <div class="preview-box">
                            <h4>ì›ë³¸ ì´ë¯¸ì§€</h4>
                            <div class="preview-image-container">
                                <img id="convertPreviewImage" class="preview-image" src="" alt="ë¯¸ë¦¬ë³´ê¸°">
                            </div>
                            <div class="image-info" id="convertImageInfo">
                                <p>íŒŒì¼ëª…: <span id="convertFileName">-</span></p>
                                <p>í¬ê¸°: <span id="convertImageSize">-</span></p>
                                <p>í•´ìƒë„: <span id="convertImageDimensions">-</span></p>
                                <p>í˜•ì‹: <span id="convertImageFormat">-</span></p>
                            </div>
                        </div>
                    </div>

                    <div class="options-area">
                        <div class="option-group">
                            <label class="option-label">ì¶œë ¥ í˜•ì‹ ì„ íƒ</label>
                            <div class="option-row">
                                <select class="format-select" id="outputFormat">
                                    <option value="jpeg">JPG (JPEG)</option>
                                    <option value="png">PNG</option>
                                    <option value="gif">GIF</option>
                                    <option value="webp">WebP</option>
                                    <option value="tiff">TIFF</option>
                                    <option value="svg">SVG</option>
                                </select>
                            </div>
                        </div>

                        <div class="option-group" id="qualityOption">
                            <label class="option-label">í’ˆì§ˆ ì„¤ì •</label>
                            <div class="quality-container">
                                <input type="range" class="quality-slider" id="convertQuality" min="10" max="100" value="90">
                                <span class="quality-value" id="convertQualityValue">90%</span>
                            </div>
                        </div>

                        <div class="action-buttons">
                            <button class="action-btn success" id="convertBtn" onclick="convertImage()" disabled>
                                ğŸ”„ ë³€í™˜í•˜ê¸°
                            </button>
                            <button class="action-btn secondary" onclick="resetConvert()">
                                ğŸ—‘ï¸ ì´ˆê¸°í™”
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- ì´ë¯¸ì§€ í¸ì§‘ íƒ­ -->
        <div class="tab-content" id="editTab">
            <div class="section-card">
                <h3 class="section-title">âœ‚ï¸ ì´ë¯¸ì§€ í¸ì§‘</h3>
                
                <div class="upload-area" id="editUploadArea" onclick="document.getElementById('editFileInput').click()">
                    <div class="upload-icon">ğŸ–¼ï¸</div>
                    <h3>í¸ì§‘í•  ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</h3>
                    <p>ë¦¬ì‚¬ì´ì¦ˆ, í¬ë¡­, ì••ì¶• ê¸°ëŠ¥ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤</p>
                    <button class="upload-btn" onclick="event.stopPropagation();">íŒŒì¼ ì„ íƒ</button>
                    <div class="supported-formats">
                        <span class="format-badge">JPG</span>
                        <span class="format-badge">PNG</span>
                        <span class="format-badge">GIF</span>
                        <span class="format-badge">WebP</span>
                    </div>
                    <input type="file" id="editFileInput" accept=".jpg,.jpeg,.png,.gif,.webp" style="display: none">
                </div>

                <div class="preview-area" id="editPreviewArea">
                    <!-- ì›ë³¸ ì •ë³´ -->
                    <div class="image-info" id="editImageInfo" style="margin-bottom: 1.5rem;">
                        <p>ğŸ“ íŒŒì¼ëª…: <span id="editFileName">-</span></p>
                        <p>ğŸ“ ì›ë³¸ í¬ê¸°: <span id="editOriginalSize">-</span></p>
                        <p>ğŸ’¾ íŒŒì¼ í¬ê¸°: <span id="editFileSize">-</span></p>
                    </div>

                    <!-- ë¦¬ì‚¬ì´ì¦ˆ ì˜µì…˜ -->
                    <div class="options-area">
                        <div class="option-group">
                            <label class="option-label">ğŸ“ ë¦¬ì‚¬ì´ì¦ˆ</label>
                            <div class="resize-options">
                                <div class="resize-input-group">
                                    <label>ë„ˆë¹„:</label>
                                    <input type="number" class="number-input" id="resizeWidth" placeholder="px" min="1">
                                </div>
                                <button class="lock-ratio-btn active" id="lockRatioBtn" onclick="toggleLockRatio()" title="ë¹„ìœ¨ ê³ ì •">
                                    ğŸ”—
                                </button>
                                <div class="resize-input-group">
                                    <label>ë†’ì´:</label>
                                    <input type="number" class="number-input" id="resizeHeight" placeholder="px" min="1">
                                </div>
                                <div class="resize-input-group">
                                    <label>ë˜ëŠ” ë¹„ìœ¨:</label>
                                    <input type="number" class="number-input" id="resizePercent" placeholder="%" value="100" min="1" max="500">
                                    <span style="color: #a1a1aa;">%</span>
                                </div>
                            </div>
                        </div>

                        <div class="option-group">
                            <label class="option-label">ğŸ’¾ íŒŒì¼ í¬ê¸° ì••ì¶• (í’ˆì§ˆ)</label>
                            <div class="quality-container">
                                <input type="range" class="quality-slider" id="editQuality" min="10" max="100" value="90">
                                <span class="quality-value" id="editQualityValue">90%</span>
                            </div>
                            <p style="color: #71717a; font-size: 0.85rem; margin-top: 0.5rem;">
                                í’ˆì§ˆì„ ë‚®ì¶”ë©´ íŒŒì¼ í¬ê¸°ê°€ ì¤„ì–´ë“­ë‹ˆë‹¤
                            </p>
                        </div>

                        <div class="action-buttons">
                            <button class="action-btn" id="applyResizeBtn" onclick="applyResize()" disabled>
                                ğŸ“ ë¦¬ì‚¬ì´ì¦ˆ ì ìš©
                            </button>
                            <button class="action-btn" id="toggleCropBtn" onclick="toggleCrop()" disabled>
                                âœ‚ï¸ í¬ë¡­ ëª¨ë“œ
                            </button>
                        </div>
                    </div>

                    <!-- í¬ë¡­ ì˜ì—­ -->
                    <div class="crop-container" id="cropContainer">
                        <div class="crop-preview" id="cropPreview">
                            <img id="cropImage" src="" alt="í¬ë¡­ ë¯¸ë¦¬ë³´ê¸°">
                        </div>
                        <div class="crop-controls">
                            <span style="color: #a1a1aa;">ë¹„ìœ¨:</span>
                            <div class="aspect-ratio-btns">
                                <button class="ratio-btn active" onclick="setAspectRatio(NaN)">ììœ </button>
                                <button class="ratio-btn" onclick="setAspectRatio(1)">1:1</button>
                                <button class="ratio-btn" onclick="setAspectRatio(4/3)">4:3</button>
                                <button class="ratio-btn" onclick="setAspectRatio(16/9)">16:9</button>
                                <button class="ratio-btn" onclick="setAspectRatio(3/2)">3:2</button>
                            </div>
                            <button class="action-btn success" onclick="applyCrop()">âœ‚ï¸ í¬ë¡­ ì ìš©</button>
                            <button class="action-btn secondary" onclick="cancelCrop()">ì·¨ì†Œ</button>
                        </div>
                    </div>

                    <!-- ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸° -->
                    <div class="preview-container" style="margin-top: 1.5rem;">
                        <div class="preview-box">
                            <h4>í¸ì§‘ ê²°ê³¼</h4>
                            <div class="preview-image-container">
                                <img id="editResultImage" class="preview-image" src="" alt="ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°">
                            </div>
                            <div class="image-info" id="editResultInfo">
                                <p>ìƒˆ í¬ê¸°: <span id="editNewSize">-</span></p>
                                <p>ì˜ˆìƒ íŒŒì¼ í¬ê¸°: <span id="editNewFileSize">-</span></p>
                            </div>
                        </div>
                    </div>

                    <div class="action-buttons" style="margin-top: 1.5rem;">
                        <button class="action-btn success" id="downloadEditBtn" onclick="downloadEditedImage()" disabled>
                            ğŸ’¾ ë‹¤ìš´ë¡œë“œ
                        </button>
                        <button class="action-btn secondary" onclick="resetEdit()">
                            ğŸ—‘ï¸ ì´ˆê¸°í™”
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- í”„ë¡œê·¸ë ˆìŠ¤ ì˜¤ë²„ë ˆì´ -->
    <div class="progress-overlay" id="progressOverlay">
        <div class="progress-card">
            <div class="spinner"></div>
            <h3 id="progressTitle">ì²˜ë¦¬ ì¤‘...</h3>
        </div>
    </div>

    <!-- í† ìŠ¤íŠ¸ ì»¨í…Œì´ë„ˆ -->
    <div class="toast-container" id="toastContainer"></div>

    <footer>
        <p>&copy; KAMIC Lab. All rights reserved.</p>
    </footer>

    <script>
        // ì „ì—­ ìƒíƒœ
        let convertImage_data = null;
        let editImage_data = null;
        let editCanvas = null;
        let cropper = null;
        let isLockRatio = true;
        let originalWidth = 0;
        let originalHeight = 0;
        let aspectRatio = 1;

        // ë¡œê·¸ì¸ ìƒíƒœ í™•ì¸
        function checkLoginStatus() {
            let isLoggedIn = localStorage.getItem('isLoggedIn') === 'true' || 
                             sessionStorage.getItem('isLoggedIn') === 'true';
            
            if (!isLoggedIn) {
                alert('ì´ ê¸°ëŠ¥ì„ ì‚¬ìš©í•˜ë ¤ë©´ ë¡œê·¸ì¸ì´ í•„ìš”í•©ë‹ˆë‹¤.');
                window.location.href = 'index.html';
                return false;
            }
            return true;
        }

        // ì´ˆê¸°í™”
        function init() {
            if (!checkLoginStatus()) return;
            
            setupConvertUpload();
            setupEditUpload();
            setupQualitySliders();
            setupResizeInputs();
        }

        // íƒ­ ì „í™˜
        function switchTab(tabName) {
            document.querySelectorAll('.tab-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.tab === tabName);
            });
            document.querySelectorAll('.tab-content').forEach(content => {
                content.classList.toggle('active', content.id === tabName + 'Tab');
            });
        }

        // í™•ì¥ì ë³€í™˜ ì—…ë¡œë“œ ì„¤ì •
        function setupConvertUpload() {
            const uploadArea = document.getElementById('convertUploadArea');
            const fileInput = document.getElementById('convertFileInput');

            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });

            uploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                if (e.dataTransfer.files.length > 0) {
                    handleConvertFile(e.dataTransfer.files[0]);
                }
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleConvertFile(e.target.files[0]);
                }
            });
        }

        // í™•ì¥ì ë³€í™˜ íŒŒì¼ ì²˜ë¦¬
        async function handleConvertFile(file) {
            const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp', 'image/svg+xml', 'image/tiff'];
            const ext = file.name.toLowerCase().split('.').pop();
            
            if (!validTypes.includes(file.type) && !['psd', 'tif', 'tiff', 'svg'].includes(ext)) {
                showToast('ì§€ì›í•˜ì§€ ì•ŠëŠ” íŒŒì¼ í˜•ì‹ì…ë‹ˆë‹¤.', 'error');
                return;
            }

            showProgress('ì´ë¯¸ì§€ ë¡œë”© ì¤‘...');

            try {
                let imageData;
                
                if (ext === 'psd') {
                    imageData = await loadPSD(file);
                } else if (ext === 'tif' || ext === 'tiff') {
                    imageData = await loadTIFF(file);
                } else {
                    imageData = await loadNormalImage(file);
                }

                convertImage_data = imageData;
                
                // ë¯¸ë¦¬ë³´ê¸° í‘œì‹œ
                document.getElementById('convertPreviewImage').src = imageData.dataUrl;
                document.getElementById('convertFileName').textContent = file.name;
                document.getElementById('convertImageSize').textContent = formatFileSize(file.size);
                document.getElementById('convertImageDimensions').textContent = `${imageData.width} Ã— ${imageData.height}px`;
                document.getElementById('convertImageFormat').textContent = ext.toUpperCase();
                
                document.getElementById('convertPreviewArea').classList.add('show');
                document.getElementById('convertBtn').disabled = false;
                
                hideProgress();
                showToast('ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } catch (error) {
                hideProgress();
                showToast('ì´ë¯¸ì§€ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                console.error(error);
            }
        }

        // PSD íŒŒì¼ ë¡œë“œ
        async function loadPSD(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = async (e) => {
                    try {
                        const psd = new PSD(new Uint8Array(e.target.result));
                        await psd.parse();
                        const canvas = psd.image.toPng();
                        resolve({
                            dataUrl: canvas.src || canvas.toDataURL('image/png'),
                            width: psd.header.width,
                            height: psd.header.height,
                            canvas: canvas
                        });
                    } catch (err) {
                        reject(err);
                    }
                };
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        // TIFF íŒŒì¼ ë¡œë“œ
        async function loadTIFF(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const ifds = UTIF.decode(e.target.result);
                        UTIF.decodeImage(e.target.result, ifds[0]);
                        const rgba = UTIF.toRGBA8(ifds[0]);
                        
                        const canvas = document.createElement('canvas');
                        canvas.width = ifds[0].width;
                        canvas.height = ifds[0].height;
                        const ctx = canvas.getContext('2d');
                        const imgData = ctx.createImageData(canvas.width, canvas.height);
                        imgData.data.set(rgba);
                        ctx.putImageData(imgData, 0, 0);
                        
                        resolve({
                            dataUrl: canvas.toDataURL('image/png'),
                            width: canvas.width,
                            height: canvas.height,
                            canvas: canvas
                        });
                    } catch (err) {
                        reject(err);
                    }
                };
                reader.onerror = reject;
                reader.readAsArrayBuffer(file);
            });
        }

        // ì¼ë°˜ ì´ë¯¸ì§€ ë¡œë“œ
        async function loadNormalImage(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const img = new Image();
                    img.onload = () => {
                        const canvas = document.createElement('canvas');
                        canvas.width = img.width;
                        canvas.height = img.height;
                        const ctx = canvas.getContext('2d');
                        ctx.drawImage(img, 0, 0);
                        
                        resolve({
                            dataUrl: e.target.result,
                            width: img.width,
                            height: img.height,
                            canvas: canvas
                        });
                    };
                    img.onerror = reject;
                    img.src = e.target.result;
                };
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        // ì´ë¯¸ì§€ ë³€í™˜
        async function convertImage() {
            if (!convertImage_data) return;

            const format = document.getElementById('outputFormat').value;
            const quality = document.getElementById('convertQuality').value / 100;

            showProgress('ë³€í™˜ ì¤‘...');

            try {
                let dataUrl;
                const canvas = convertImage_data.canvas;

                if (format === 'svg') {
                    // SVGë¡œ ë³€í™˜ (ë˜ìŠ¤í„° ì´ë¯¸ì§€ë¥¼ SVGë¡œ ê°ì‹¸ê¸°)
                    const svgContent = `<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="${canvas.width}" height="${canvas.height}">
    <image width="${canvas.width}" height="${canvas.height}" xlink:href="${canvas.toDataURL('image/png')}"/>
</svg>`;
                    dataUrl = 'data:image/svg+xml;charset=utf-8,' + encodeURIComponent(svgContent);
                } else if (format === 'tiff') {
                    // TIFFë¡œ ë³€í™˜
                    const ctx = canvas.getContext('2d');
                    const imgData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const tiffData = UTIF.encodeImage(imgData.data, canvas.width, canvas.height);
                    const blob = new Blob([tiffData], { type: 'image/tiff' });
                    dataUrl = URL.createObjectURL(blob);
                    
                    // ë‹¤ìš´ë¡œë“œ
                    const link = document.createElement('a');
                    link.href = dataUrl;
                    link.download = `converted_image.tiff`;
                    link.click();
                    URL.revokeObjectURL(dataUrl);
                    
                    hideProgress();
                    showToast('TIFF íŒŒì¼ì´ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                    return;
                } else {
                    const mimeType = format === 'jpeg' ? 'image/jpeg' : 
                                     format === 'png' ? 'image/png' :
                                     format === 'gif' ? 'image/gif' :
                                     format === 'webp' ? 'image/webp' : 'image/png';
                    
                    dataUrl = canvas.toDataURL(mimeType, quality);
                }

                // ë‹¤ìš´ë¡œë“œ
                const link = document.createElement('a');
                link.href = dataUrl;
                link.download = `converted_image.${format === 'jpeg' ? 'jpg' : format}`;
                link.click();

                hideProgress();
                showToast('ë³€í™˜ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } catch (error) {
                hideProgress();
                showToast('ë³€í™˜ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                console.error(error);
            }
        }

        // í™•ì¥ì ë³€í™˜ ì´ˆê¸°í™”
        function resetConvert() {
            convertImage_data = null;
            document.getElementById('convertPreviewArea').classList.remove('show');
            document.getElementById('convertFileInput').value = '';
            document.getElementById('convertBtn').disabled = true;
        }

        // ì´ë¯¸ì§€ í¸ì§‘ ì—…ë¡œë“œ ì„¤ì •
        function setupEditUpload() {
            const uploadArea = document.getElementById('editUploadArea');
            const fileInput = document.getElementById('editFileInput');

            uploadArea.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadArea.classList.add('drag-over');
            });

            uploadArea.addEventListener('dragleave', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
            });

            uploadArea.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadArea.classList.remove('drag-over');
                if (e.dataTransfer.files.length > 0) {
                    handleEditFile(e.dataTransfer.files[0]);
                }
            });

            fileInput.addEventListener('change', (e) => {
                if (e.target.files.length > 0) {
                    handleEditFile(e.target.files[0]);
                }
            });
        }

        // í¸ì§‘ìš© íŒŒì¼ ì²˜ë¦¬
        async function handleEditFile(file) {
            const validTypes = ['image/jpeg', 'image/png', 'image/gif', 'image/webp'];
            
            if (!validTypes.includes(file.type)) {
                showToast('JPG, PNG, GIF, WebP íŒŒì¼ë§Œ ì§€ì›í•©ë‹ˆë‹¤.', 'error');
                return;
            }

            showProgress('ì´ë¯¸ì§€ ë¡œë”© ì¤‘...');

            try {
                const imageData = await loadNormalImage(file);
                editImage_data = imageData;
                editCanvas = imageData.canvas;
                originalWidth = imageData.width;
                originalHeight = imageData.height;
                aspectRatio = originalWidth / originalHeight;

                // ì •ë³´ í‘œì‹œ
                document.getElementById('editFileName').textContent = file.name;
                document.getElementById('editOriginalSize').textContent = `${imageData.width} Ã— ${imageData.height}px`;
                document.getElementById('editFileSize').textContent = formatFileSize(file.size);
                
                // ë¦¬ì‚¬ì´ì¦ˆ ì…ë ¥ ì´ˆê¸°í™”
                document.getElementById('resizeWidth').value = imageData.width;
                document.getElementById('resizeHeight').value = imageData.height;
                document.getElementById('resizePercent').value = 100;

                // ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
                document.getElementById('editResultImage').src = imageData.dataUrl;
                updateEditResult();

                // í¬ë¡­ ì´ë¯¸ì§€ ì„¤ì •
                document.getElementById('cropImage').src = imageData.dataUrl;

                document.getElementById('editPreviewArea').classList.add('show');
                document.getElementById('applyResizeBtn').disabled = false;
                document.getElementById('toggleCropBtn').disabled = false;
                document.getElementById('downloadEditBtn').disabled = false;

                hideProgress();
                showToast('ì´ë¯¸ì§€ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } catch (error) {
                hideProgress();
                showToast('ì´ë¯¸ì§€ ë¡œë“œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
                console.error(error);
            }
        }

        // í’ˆì§ˆ ìŠ¬ë¼ì´ë” ì„¤ì •
        function setupQualitySliders() {
            const convertSlider = document.getElementById('convertQuality');
            const convertValue = document.getElementById('convertQualityValue');
            
            convertSlider.addEventListener('input', () => {
                convertValue.textContent = convertSlider.value + '%';
            });

            const editSlider = document.getElementById('editQuality');
            const editValue = document.getElementById('editQualityValue');
            
            editSlider.addEventListener('input', () => {
                editValue.textContent = editSlider.value + '%';
                updateEditResult();
            });
        }

        // ë¦¬ì‚¬ì´ì¦ˆ ì…ë ¥ ì„¤ì •
        function setupResizeInputs() {
            const widthInput = document.getElementById('resizeWidth');
            const heightInput = document.getElementById('resizeHeight');
            const percentInput = document.getElementById('resizePercent');

            widthInput.addEventListener('input', () => {
                if (isLockRatio && originalWidth > 0) {
                    const newWidth = parseInt(widthInput.value) || 0;
                    const newHeight = Math.round(newWidth / aspectRatio);
                    heightInput.value = newHeight;
                    percentInput.value = Math.round((newWidth / originalWidth) * 100);
                }
            });

            heightInput.addEventListener('input', () => {
                if (isLockRatio && originalHeight > 0) {
                    const newHeight = parseInt(heightInput.value) || 0;
                    const newWidth = Math.round(newHeight * aspectRatio);
                    widthInput.value = newWidth;
                    percentInput.value = Math.round((newHeight / originalHeight) * 100);
                }
            });

            percentInput.addEventListener('input', () => {
                if (originalWidth > 0 && originalHeight > 0) {
                    const percent = parseInt(percentInput.value) || 100;
                    widthInput.value = Math.round(originalWidth * percent / 100);
                    heightInput.value = Math.round(originalHeight * percent / 100);
                }
            });
        }

        // ë¹„ìœ¨ ê³ ì • í† ê¸€
        function toggleLockRatio() {
            isLockRatio = !isLockRatio;
            document.getElementById('lockRatioBtn').classList.toggle('active', isLockRatio);
            document.getElementById('lockRatioBtn').textContent = isLockRatio ? 'ğŸ”—' : 'ğŸ”“';
        }

        // ë¦¬ì‚¬ì´ì¦ˆ ì ìš©
        function applyResize() {
            if (!editImage_data) return;

            const newWidth = parseInt(document.getElementById('resizeWidth').value) || originalWidth;
            const newHeight = parseInt(document.getElementById('resizeHeight').value) || originalHeight;

            if (newWidth < 1 || newHeight < 1) {
                showToast('ìœ íš¨í•œ í¬ê¸°ë¥¼ ì…ë ¥í•˜ì„¸ìš”.', 'error');
                return;
            }

            showProgress('ë¦¬ì‚¬ì´ì¦ˆ ì¤‘...');

            try {
                const canvas = document.createElement('canvas');
                canvas.width = newWidth;
                canvas.height = newHeight;
                const ctx = canvas.getContext('2d');
                
                // ì›ë³¸ ì´ë¯¸ì§€ ë¡œë“œ
                const img = new Image();
                img.onload = () => {
                    ctx.drawImage(img, 0, 0, newWidth, newHeight);
                    editCanvas = canvas;
                    
                    const quality = document.getElementById('editQuality').value / 100;
                    const dataUrl = canvas.toDataURL('image/jpeg', quality);
                    document.getElementById('editResultImage').src = dataUrl;
                    
                    updateEditResult();
                    hideProgress();
                    showToast('ë¦¬ì‚¬ì´ì¦ˆê°€ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
                };
                img.src = editImage_data.dataUrl;
            } catch (error) {
                hideProgress();
                showToast('ë¦¬ì‚¬ì´ì¦ˆ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // í¬ë¡­ ëª¨ë“œ í† ê¸€
        function toggleCrop() {
            const cropContainer = document.getElementById('cropContainer');
            const isVisible = cropContainer.classList.contains('show');

            if (isVisible) {
                cancelCrop();
            } else {
                cropContainer.classList.add('show');
                
                if (cropper) {
                    cropper.destroy();
                }
                
                const cropImage = document.getElementById('cropImage');
                cropImage.src = editImage_data.dataUrl;
                
                cropper = new Cropper(cropImage, {
                    viewMode: 1,
                    autoCropArea: 0.8,
                    responsive: true,
                    background: false
                });
            }
        }

        // í¬ë¡­ ë¹„ìœ¨ ì„¤ì •
        function setAspectRatio(ratio) {
            if (cropper) {
                cropper.setAspectRatio(ratio);
            }
            
            document.querySelectorAll('.ratio-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // í¬ë¡­ ì ìš©
        function applyCrop() {
            if (!cropper) return;

            showProgress('í¬ë¡­ ì ìš© ì¤‘...');

            try {
                const croppedCanvas = cropper.getCroppedCanvas();
                editCanvas = croppedCanvas;
                
                const quality = document.getElementById('editQuality').value / 100;
                const dataUrl = croppedCanvas.toDataURL('image/jpeg', quality);
                
                document.getElementById('editResultImage').src = dataUrl;
                document.getElementById('resizeWidth').value = croppedCanvas.width;
                document.getElementById('resizeHeight').value = croppedCanvas.height;
                
                updateEditResult();
                cancelCrop();
                
                hideProgress();
                showToast('í¬ë¡­ì´ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
            } catch (error) {
                hideProgress();
                showToast('í¬ë¡­ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.', 'error');
            }
        }

        // í¬ë¡­ ì·¨ì†Œ
        function cancelCrop() {
            document.getElementById('cropContainer').classList.remove('show');
            if (cropper) {
                cropper.destroy();
                cropper = null;
            }
        }

        // í¸ì§‘ ê²°ê³¼ ì—…ë°ì´íŠ¸
        function updateEditResult() {
            if (!editCanvas) return;

            const quality = document.getElementById('editQuality').value / 100;
            const dataUrl = editCanvas.toDataURL('image/jpeg', quality);
            
            document.getElementById('editResultImage').src = dataUrl;
            document.getElementById('editNewSize').textContent = `${editCanvas.width} Ã— ${editCanvas.height}px`;
            
            // ì˜ˆìƒ íŒŒì¼ í¬ê¸° ê³„ì‚°
            const base64Length = dataUrl.length - 'data:image/jpeg;base64,'.length;
            const estimatedSize = Math.round(base64Length * 0.75);
            document.getElementById('editNewFileSize').textContent = formatFileSize(estimatedSize);
        }

        // í¸ì§‘ëœ ì´ë¯¸ì§€ ë‹¤ìš´ë¡œë“œ
        function downloadEditedImage() {
            if (!editCanvas) return;

            const quality = document.getElementById('editQuality').value / 100;
            const dataUrl = editCanvas.toDataURL('image/jpeg', quality);

            const link = document.createElement('a');
            link.href = dataUrl;
            link.download = 'edited_image.jpg';
            link.click();

            showToast('ì´ë¯¸ì§€ê°€ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤.', 'success');
        }

        // í¸ì§‘ ì´ˆê¸°í™”
        function resetEdit() {
            editImage_data = null;
            editCanvas = null;
            
            if (cropper) {
                cropper.destroy();
                cropper = null;
            }
            
            document.getElementById('editPreviewArea').classList.remove('show');
            document.getElementById('cropContainer').classList.remove('show');
            document.getElementById('editFileInput').value = '';
            document.getElementById('applyResizeBtn').disabled = true;
            document.getElementById('toggleCropBtn').disabled = true;
            document.getElementById('downloadEditBtn').disabled = true;
        }

        // ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜
        function formatFileSize(bytes) {
            if (bytes < 1024) return bytes + ' B';
            if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
            return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
        }

        function showProgress(title) {
            document.getElementById('progressTitle').textContent = title;
            document.getElementById('progressOverlay').classList.add('show');
        }

        function hideProgress() {
            document.getElementById('progressOverlay').classList.remove('show');
        }

        function showToast(message, type = 'info') {
            const container = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = 'â„¹ï¸';
            if (type === 'success') icon = 'âœ…';
            if (type === 'error') icon = 'âŒ';

            toast.innerHTML = `<span>${icon}</span><span>${message}</span>`;
            container.appendChild(toast);

            setTimeout(() => {
                toast.style.animation = 'slideIn 0.3s ease reverse';
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }

        // ì´ˆê¸°í™” ì‹¤í–‰
        init();
    </script>
</body>
</html>

